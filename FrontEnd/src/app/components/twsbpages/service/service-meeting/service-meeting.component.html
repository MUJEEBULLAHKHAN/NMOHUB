<div class="calendar-container">
  <!-- Header with navigation -->
  <div class="calendar-header">
    <div class="nav-controls">
      <button class="nav-btn" (click)="navigatePrevious()">&#8249;</button>
      <button class="nav-btn" (click)="navigateNext()">&#8250;</button>
      <button class="today-btn" (click)="goToToday()">today</button>
    </div>
    <div class="date-range">{{ getDateRangeDisplay() }}</div>
    <div class="view-controls">
      <!-- <button 
            class="view-btn" 
            [class.active]="currentView === 'month'"
            (click)="setView('month')">month</button> -->
      <button class="view-btn" [class.active]="currentView === 'week'" (click)="setView('week')">week</button>
      <!-- <button 
            class="view-btn" 
            [class.active]="currentView === 'year'"
            (click)="setView('year')">year</button> -->
    </div>
  </div>

  <!-- Weekly View -->
  <div class="calendar-grid" *ngIf="currentView === 'week'">
    <!-- Day headers -->
    <div class="day-headers">
      <div class="time-column"></div>
      <div class="day-header" *ngFor="let day of currentWeekDays">
        <div class="day-name">{{ formatDayHeader(day) }}</div>
      </div>
    </div>

    <!-- Time slots and events -->
    <div class="time-grid">
      <div class="time-row" *ngFor="let timeSlot of timeSlots">
        <div class="time-label">{{ timeSlot }}</div>
        <div class="day-cell" *ngFor="let day of currentWeekDays" (click)="selectTimeSlot(day, timeSlot)"
          [class.selectable]="!isSlotOccupied(day, timeSlot)"
          [class.selected]="isSlotSelected(day, timeSlot) && !isSelectedSlotMerged(day, timeSlot)"
          [class.selected-merged-start]="isSelectedSlotStart(day, timeSlot)"
          [class.selected-merged-middle]="isSelectedSlotMiddle(day, timeSlot)"
          [class.selected-merged-end]="isSelectedSlotEnd(day, timeSlot)"
          [class.merged-slot-start]="isMergedSlotStart(day, timeSlot)"
          [class.merged-slot-middle]="isMergedSlotMiddle(day, timeSlot)"
          [class.merged-slot-end]="isMergedSlotEnd(day, timeSlot)">
          <div *ngFor="let event of getEventsForDayAndTime(day, timeSlot)" class="event"
            [class.event-gray]="event.type === 'gray'" [class.event-green]="event.type === 'green'"
            [style.height.px]="getEventHeight(event)" [style.z-index]="10">
            <div class="event-time">{{ event.startTime }} - {{ event.endTime }}</div>
            <div class="event-title">
              <span style="font-weight: bold;" *ngIf="event.status === 'Available'">
                Slot Available
              </span>
              <span style="color: red;font-weight: bold;" *ngIf="event.status === 'Booked'">
                Slot Booked
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Monthly View -->
  <!-- <div class="calendar-grid" *ngIf="currentView === 'month'">
        <div class="month-grid">
          <div class="month-header">
            <div class="month-day-header" *ngFor="let day of weekDayNames">{{ day }}</div>
          </div>
          <div class="month-week" *ngFor="let week of monthWeeks">
            <div 
              class="month-day-cell" 
              *ngFor="let day of week"
              [class.other-month]="!isSameMonth(day, currentDate)"
              [class.today]="isToday(day)">
              <div class="month-day-number">{{ day.getDate() }}</div>
              <div class="month-events">
                <div 
                  *ngFor="let event of getEventsForDay(day)"
                  class="month-event"
                  [class.event-gray]="event.type === 'gray'"
                  [class.event-green]="event.type === 'green'">
                  {{ event.title }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->

  <!-- Yearly View -->
  <!-- <div class="calendar-grid" *ngIf="currentView === 'year'">
        <div class="year-grid">
          <div class="year-month" *ngFor="let month of yearMonths">
            <div class="year-month-header">{{ getMonthName(month) }}</div>
            <div class="year-month-days">
              <div class="year-week-header">
                <div class="year-day-header" *ngFor="let day of weekDayAbbrev">{{ day }}</div>
              </div>
              <div class="year-week" *ngFor="let week of getMonthWeeks(month)">
                <div 
                  class="year-day-cell" 
                  *ngFor="let day of week"
                  [class.other-month]="!isSameMonth(day, month)"
                  [class.has-events]="hasEventsOnDay(day)">
                  {{ day.getDate() }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->






  <!-- Booking Form Modal -->
  <div class="booking-modal" *ngIf="showBookingForm" (click)="closeBookingForm()">
    <div class="booking-form" (click)="$event.stopPropagation()">
      <h3>Create New Booking</h3>
      <p>Date: {{scheduleMeetingModel.ScheduleDate | date:'MM-dd-yyyy'}}</p>
      <p>Time: {{startTime}} To {{endTime}}</p>
      <p>Duration: 1 hour(s)</p>

      <div class="row mb-3">

        <div class="col-md-12  mb-3">
          <div class="form-group text-start">
            <div class="form-group text-start">
              <label class="mb-2"> Feedback <span class="text-danger">*</span></label>

              <textarea style="padding: 15px;" rows="5" name="" id="" required #methodEndInput="ngModel" matInput
                [(ngModel)]="scheduleMeetingModel.Feedback" class="form-control" placeholder="Comment">

                        </textarea>
            </div>
          </div>
        </div>

        <div class="row  mb-3">
          <!-- <label class="mb-2">Is Meeting Virtual <span class="text-danger">*</span></label> -->

          <!-- <div class="row"> -->

          <div class="col-md-6">

            <div class="form-group text-start">
              <label> Is Meeting Virtual<span class="text-danger">*</span></label>
              <!-- <ng-select [items]="platFormOptions" [(ngModel)]="scheduleMeetingModel.Platform" [selectOnTab]="true"
                  bindValue="name" bindLabel="name" labelForId="name" [multiple]="false"
                  placeholder="Select Meeting Platform">
                </ng-select> -->
<!-- 
              <input style="margin: 0px 5px;" [(ngModel)]="scheduleMeetingModel.IsVirtual" [value]="true" type="radio"
                name="AllowDiscountOnInvoice" id="AllowDiscountOnInvoice" class="form-check-input">

              <label for="AllowDiscountOnInvoice" class="form-check-label"> No
              </label>
              <input style="margin: 0px 5px;" [(ngModel)]="scheduleMeetingModel.IsVirtual" [value]="false" type="radio"
                name="AllowDiscountOnInvoice" id="AllowDiscountOnInvoice" class="form-check-input"> -->


            </div>


            <label for="AllowDiscountOnInvoice" class="form-check-label"> Yes
            </label>
            <input style="margin: 0px 5px;" [(ngModel)]="scheduleMeetingModel.IsVirtual" [value]="true" type="radio"
              name="AllowDiscountOnInvoice" id="AllowDiscountOnInvoice" class="form-check-input">

            <label for="AllowDiscountOnInvoice" class="form-check-label"> No
            </label>
            <input style="margin: 0px 5px;" [(ngModel)]="scheduleMeetingModel.IsVirtual" [value]="false" type="radio"
              name="AllowDiscountOnInvoice" id="AllowDiscountOnInvoice" class="form-check-input">


          </div>

          <div class="col-md-6" *ngIf="scheduleMeetingModel.IsVirtual">

            <div class="form-group text-start">
              <label> Meeting Platform<span class="text-danger">*</span></label>
              <ng-select [items]="platFormOptions" [(ngModel)]="scheduleMeetingModel.Platform" [selectOnTab]="true"
                bindValue="name" bindLabel="name" labelForId="name" [multiple]="false"
                placeholder="Select Meeting Platform">
              </ng-select>
            </div>

          </div>

          <!-- </div> -->



        </div>

        <div class="col-md-12  mb-3" *ngIf="scheduleMeetingModel.IsVirtual">
          <div class="form-group text-start">
            <div class="form-group text-start">
              <label class="mb-2"> Url <span class="text-danger">*</span></label>

              <input type="text" name="" id="" required #methodUrlInput="ngModel" matInput
                [(ngModel)]="scheduleMeetingModel.Url" class="form-control" placeholder="Url">
            </div>
          </div>
        </div>

      </div>


      <!-- <div class="form-group">
            <label for="title">Event Title:</label>
            <input 
              type="text" 
              id="title"
              [(ngModel)]="newBooking.title" 
              placeholder="Enter event title">
          </div>
          
          <div class="form-group">
            <label for="duration">Duration (hours):</label>
            <select id="duration" [(ngModel)]="newBooking.duration">
              <option value="1">1 hour</option>
              <option value="2">2 hours</option>
              <option value="3">3 hours</option>
              <option value="4">4 hours</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="type">Event Type:</label>
            <select id="type" [(ngModel)]="newBooking.type">
              <option value="gray">Gray</option>
              <option value="green">Green</option>
            </select>
          </div> -->

      <div class="form-actions">
        <button class="btn-save" (click)="createBooking()">Save
          <span *ngIf="showLoader" role="status" aria-hidden="true"
                        class="spinner-border spinner-border-sm align-middle"></span>
        </button>
        <button class="btn-cancel" (click)="closeBookingForm()">Cancel</button>
      </div>
    </div>
  </div>

</div>