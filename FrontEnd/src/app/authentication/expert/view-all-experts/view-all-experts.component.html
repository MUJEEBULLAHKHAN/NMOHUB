<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="medium">Expert Management</h2>
    <button class="btn" (click)="refreshExperts()" [disabled]="isLoading">
      <i class="bi bi-arrow-clockwise"></i> Refresh
    </button>
  </div>

  <!-- Filters -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-6">
          <label for="search" class="form-label">Search Experts</label>
          <input type="text" class="form-control" id="search" placeholder="Search by name, email, or phone..."
            [(ngModel)]="searchTerm" (input)="onSearch()">
        </div>
        <div class="col-md-6">
          <label for="statusFilter" class="form-label">Filter by Status</label>
          <select class="form-select" id="statusFilter" [(ngModel)]="statusFilter" (change)="onStatusFilterChange()">
            <option *ngFor="let option of statusOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading experts...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="alert alert-danger" role="alert">
    {{ errorMessage }}
    <button class="btn btn-sm btn-outline-danger ms-3" (click)="loadExperts()">Retry</button>
  </div>

  <!-- Experts Table -->
  <div *ngIf="!isLoading && !errorMessage && filteredExperts.length > 0" class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>Profile</th>
          <th>Expert Name</th>
          <!-- <th>Email</th> -->
          <!-- <th>Phone</th> -->
          <th>Nationality</th>
          <th>Experience</th>
          <!-- <th>Status</th> -->
          <th>Areas of Expertise</th>
          <th>Member Since</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let expert of filteredExperts">
          <!-- Profile Picture -->
          <td>
            <img [src]="getProfilePictureUrl(expert.profilePicture)" [alt]="expert.fullName" class="rounded-circle"
              style="width: 40px; height: 40px; object-fit: cover;">
          </td>

          <!-- Expert Info -->
          <td><strong>{{ expert.fullName }}</strong></td>
          <!-- <td><a [href]="'mailto:' + expert.email">{{ expert.email }}</a></td> -->
          <!-- <td>{{ expert.phoneNumber || 'Not provided' }}</td> -->
          <td>{{ expert.nationality || 'Not provided' }}</td>
          <td>{{ expert.experienceYears }} yrs</td>

          <!-- Status -->
          <!-- <td>
          <span class="badge" [ngClass]="getStatusBadgeClass(expert.status)">
            {{ expert.status }}
          </span>
        </td> -->

          <!-- Areas of Expertise -->
          <td>
            <span *ngFor="let expertise of expert.areaOfExpertiseNames" class="badge bg-light text-dark border me-1">
              {{ expertise }}
            </span>
          </td>

          <!-- Member Since -->
          <td>{{ formatDate(expert.createdAt) }}</td>

          <!-- Actions -->
          <td class="td">
            <button class="btn" [routerLink]="['/experts', expert.expertID, 'view']">
              <i class="bi bi-eye"></i>
            </button>
            <button class="btn" style="margin-left: 10px;" [routerLink]="['/experts', expert.expertID, 'edit']">
              <i class="bi bi-pencil"></i>
            </button>
            <!-- <button class="btn btn-sm btn-outline-danger" (click)="deleteExpert(expert)" title="Delete">
            <i class="bi bi-trash"></i>
          </button> -->
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Results Count -->
    <div class="mt-2 text-muted">
      Showing {{ filteredExperts.length }} of {{ experts.length }} experts
    </div>
  </div>

  <!-- No Data -->
  <div *ngIf="!isLoading && !errorMessage && filteredExperts.length === 0" class="alert alert-info">
    No experts found matching your criteria.
  </div>

</div>